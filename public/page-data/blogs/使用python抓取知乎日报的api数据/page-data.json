{
    "componentChunkName": "component---src-templates-blog-post-tsx",
    "path": "/blogs/使用python抓取知乎日报的api数据/",
    "result": {"data":{"site":{"siteMetadata":{"title":"张小伦的网络日志","description":"欢迎来到张小伦的网络日志 \n\t\t一个记录生活，分享心得的博客","menu":[{"id":"home","name":"首页","url":"/"},{"id":"blog","name":"博文","url":"/blogs"},{"id":"category","name":"分类","url":"/categories"},{"id":"archive","name":"归档","url":"/archives"},{"id":"lab","name":"实验室","url":"/labs"},{"id":"about","name":"关于我","url":"/about"}]}},"markdownRemark":{"id":"a0fcd692-847e-5543-8b26-1f3291adbace","html":"<p class=\"para\">使用 <code>urllib2</code> 抓取数据时，最简单的方法是：</p>\n<deckgo-highlight-code  theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">import urllib2, json\r\ndef getStartImage():\r\n    stream = urllib2.urlopen(&#39;http://news-at.zhihu.com/api/3/start-image/1080*1776&#39;)\r\n    start_image = json.load(stream)\r\n    start_image = json.dumps(start_image, encoding=&#39;utf-8&#39;)\r\n    return start_image</code>\n        </deckgo-highlight-code>\n<p class=\"para\">使用<code>urllib2.urlopen</code>打开参数中给出的url，返回一个 <code>instance</code>（匿名的object）。<br>\n因为这个链接本该返回的是json数据，所以可以用json库提供的<code>json.load</code>方法将对象实例解析成一个字典，直接return的话，返回的是一个字典转化成的字符串。使用<code>json.dumps()</code>将dict转换成一个json对象，参数中<code>encoding='utf-8'</code>，指定编码格式。</p>\n<!--![](http://ncuey-crispelite.stor.sinaapp.com/1413276441112.png) -->\n<p class=\"para\">但是这种方法往往会遇到 <code>HTTP Error: 403 Forbidden</code>，因为网站禁止爬虫抓去该网站的数据。可以在请求中添加 <code>http header</code>，伪装成一个浏览器发出的请求。这里需要用到 urllib2 提供的一个类<code>Reuqest</code>:</p>\n<deckgo-highlight-code  theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">urllib2.Request(url[, data][, headers][, origin_req_host][, unverifiable])</code>\n        </deckgo-highlight-code>\n<p class=\"para\">这个类是一个url请求的抽象化,其具体的使用细节可以参照<a href=\"https://docs.python.org/2/library/urllib2.html\" class=\"link-underline\">这里</a>，在这里就不说了。</p>\n<deckgo-highlight-code  theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">import urllib2, json\r\n# 设置header\r\nheaders = {&#39;User-Agent&#39;:&#39;Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.6)Gecko/20091201 Firefox/3.5.6&#39;}\r\n\r\ndef getStartImage():\r\n    req = urllib2.Request(url = &#39;http://news-at.zhihu.com/api/3/start-image/1080*1776&#39;, headers = headers)\r\n    stream = urllib2.urlopen(req)\r\n    start_image = json.load(stream)\r\n    start_image = json.dumps(start_image, encoding=&#39;utf-8&#39;)\r\n    return start_image</code>\n        </deckgo-highlight-code>","tableOfContents":"","headings":[],"frontmatter":{"title":"使用python抓取知乎日报的API数据","date":"2014-10-08","cover":null,"description":null,"categories":["Python"],"tags":["Python","笔记"]}},"previous":{"fields":{"slug":"/blogs/我的响应式web开发实践笔记-media queries 初探/"},"frontmatter":{"title":"我的响应式web开发实践笔记-Media Queries 初探"}},"next":{"fields":{"slug":"/blogs/css的盒模型回顾/"},"frontmatter":{"title":"CSS的盒模型-过去和将来","tags":["CSS","笔记"],"categories":["前端"],"status":null}}},"pageContext":{"id":"a0fcd692-847e-5543-8b26-1f3291adbace","previousPostId":"4e82c1ff-76be-567c-a3d2-c1ce921e3b1a","nextPostId":"f461abe5-b970-5c5a-9176-7937d29c1833"}},
    "staticQueryHashes": ["2841359383"]}