{
    "componentChunkName": "component---src-templates-blog-post-tsx",
    "path": "/blogs/使用CSS追踪用户信息-CSS Fingerpoint/",
    "result": {"data":{"site":{"siteMetadata":{"title":"张小伦的网络日志","description":"欢迎来到张小伦的网络日志 \n\t\t一个记录生活，分享心得的博客","menu":[{"id":"home","name":"首页","url":"/"},{"id":"blog","name":"博文","url":"/blogs"},{"id":"category","name":"分类","url":"/categories"},{"id":"archive","name":"归档","url":"/archives"},{"id":"lab","name":"实验室","url":"/labs"},{"id":"about","name":"关于我","url":"/about"}]}},"markdownRemark":{"id":"ffcae36c-60a9-514c-b176-bb27bb714b90","html":"<p class=\"para\">今天网上冲浪时看到这个网站 <a href=\"https://csstracking.dev/\" class=\"link-underline\">https://csstracking.dev/</a> ，提到一种使用CSS技术实现用户信息追踪的方案，挺有意思的。作者 <a href=\"https://github.com/OliverBrotchie\" class=\"link-underline\">OliverBrotchie</a>，项目地址 <a href=\"https://github.com/OliverBrotchie/CSS-Fingerprint\" class=\"link-underline\">https://github.com/OliverBrotchie/CSS-Fingerprint</a>，这是一个基于 CSS 的指纹识别和纯 CSS ‘supercookie’ 的实验项目。</p>\n<p class=\"para\">项目介绍了几种追踪方式和这么做的原因。简单总结就是利用浏览器加载CSS的机制，将数据信息通过接口发送给服务端，从而达到绕过现有常见的反追踪策略。具体的细节可以往下看。</p>\n<h2 class=\"heading subtitle heading\" id=\"使用-Media-Query-追踪设备特征\" style=\"position:relative;\"><a href=\"#%E4%BD%BF%E7%94%A8-Media-Query-%E8%BF%BD%E8%B8%AA%E8%AE%BE%E5%A4%87%E7%89%B9%E5%BE%81\" aria-label=\"使用 Media Query 追踪设备特征 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使用 Media Query 追踪设备特征</h2>\n<p class=\"para\">利用CSS的媒体查询，针对一些特定的浏览器特性，为网站设置不同的样式。当用户访问站点时，浏览器将选择一组适用于自身的样式。可以利用这个机制，使用background-image属性将浏览器的信息发送给服务端。然后服务器将响应 HTTP 状态 410 (Gone) 以避免在后续重新加载时对这些特征的发起请求。</p>\n<p class=\"para\">是不是有点意思？举一个简单的例子，检测用户设备是否有定点装置（如鼠标），以及如果有，精度如何。</p>\n<deckgo-highlight-code language=\"css\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">// 默认没有定点装置\n.pointer {\n  background-image: url(&#39;/some/url/pointer=none&#39;); \n}\n\n// 至少有一个输入途径包含一个精度有限的定点装置，比如触摸屏\n@media (any-pointer: coarse) {\n  .pointer {\n    background-image: url(&#39;/some/url/pointer=coarse&#39;);\n  }\n}\n\n// fine 至少有一个输入途径包含一个精确的定点装置。比如鼠标。\n@media (any-pointer: fine) {\n  .pointer {\n    background-image: url(&#39;/some/url/pointer=fine&#39;);\n  }\n}</code>\n        </deckgo-highlight-code>\n<h2 class=\"heading subtitle heading\" id=\"使用font-face检测字体安装\" style=\"position:relative;\"><a href=\"#%E4%BD%BF%E7%94%A8font-face%E6%A3%80%E6%B5%8B%E5%AD%97%E4%BD%93%E5%AE%89%E8%A3%85\" aria-label=\"使用font face检测字体安装 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使用font-face检测字体安装</h2>\n<p class=\"para\">通过类似的方式，在用户访问站点时，还能检测到安装的Web字体。</p>\n<deckgo-highlight-code language=\"css\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">@font-face {\n  font-family: &#39;some-font&#39;;\n  src: local(some font), url(&#39;some/url/some-font&#39;);\n}\n\n.some-font {\n  font-family:&#39;some-font&#39;;\n  view raw;\n}</code>\n        </deckgo-highlight-code>\n<p class=\"para\">如果用户的设备上没有安装对应的字体，浏览器会向CSS样式中设置的url地址发起字体下载的请求。如此一来便能知晓用户安装的字体。</p>\n<blockquote class=\"quote\">\n<p class=\"para\"><a href=\"https://github.com/OliverBrotchie/CSS-Fingerprint/issues/2\" class=\"link-underline\">https://github.com/OliverBrotchie/CSS-Fingerprint/issues/2</a> 网友 <a href=\"https://github.com/Leland\" class=\"link-underline\"><strong>Leland</strong></a> 提出这种方式在Webkit中无效。他在 Chrome 96 中测试过，<code>local()</code> 只对本地的系统字体有效。</p>\n</blockquote>\n<h2 class=\"heading subtitle heading\" id=\"利用重定向创造-CSS-Cookies\" style=\"position:relative;\"><a href=\"#%E5%88%A9%E7%94%A8%E9%87%8D%E5%AE%9A%E5%90%91%E5%88%9B%E9%80%A0-CSS-Cookies\" aria-label=\"利用重定向创造 CSS Cookies permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>利用重定向创造 CSS Cookies</h2>\n<p class=\"para\">假设用户的CSS中有类似前文中提到的使用url的属性。当用户访问站点时，浏览器会向对应的地址发起HTTP请求。此时，服务端响应状态码返回308永久重定向到一个唯一的地址。之后浏览器任何时候访问这个资源时，请求都会重定向到这个唯一的地址。</p>\n<p class=\"para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f0e2af9f3e1ec6eaaed1c2ede02ee315/fbf08/b258335ee2f153e4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 85.1063829787234%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAACvUlEQVQ4y3WUzYtcRRTF+x9TV2ayiiiCE4JLJwq6d+nCjSYbXQkiSIIkATMRgowR1DjOkJAJQaLDiIKok/54n/Vd9aa7Z35a9bpfvzBxcXhVr26de+rWuTUQ1iONR9qAMB6hA7bxPHrkuHmjxd6ewzQeYdqYGCu7fe3/NLeeQVo0LWJwpQIzPJ98bDn3vOOlFxwffWg5OmnXUtKIJaldJlkS9jLGhVp73FHg/j3Hlc8Mn3+q2N1xSbXQbYzsKRILLMkH0q7YuyAT8NNAc2xRjSDMm6dU9Eu02rMgXGXoHce0pFll+HtYdrVbHbevdIGF6oEwzyLzKNcwzCp+/+sJlXY9RcsLCU+p6xR2gcvgxXdSKQppqI0nqySl0KcSL+eVsglx3Cp0DXVUVEomQjMqJeNSLhI4SjtlogLKuFMniTHTY5ie0FMoLfkoZ3g4ocprykIgXczukHMo/viZ/LeHqDndbfbx1Z273PrmbktYC83BG++y/8oGB+tv88va6wzvbKOOQZiGcu822eWzZJfWKO7dpDINlTLkQuOncza3fuDM+kXOvLaRiAfjnYc8fvEC+6++xf7LG+yff4dylCN9g3BHFPdvMbm0lgjznesUylMIzaSUuGbGl19/x9nzb7K2fpHNre8ZVIWgGhcc/nlI9s+IuhSppl2N5pAdPGDy624aL4+sXZO+w7zmi80tbtz+llo7BnGzbmaMhaZyDcofda2V/KYcuZ4xkdM0Vq692ajwSV4nJ8xOSGiNHT1nA+NCUEqTbCPMyl9hFjvG4GeKMI9mV0lVVuvuUk7ZJpp4FAmVTeStvwKmiT3tuX7VJmz/aCik7Iz/LAt1nRJvLWYelyKRDzOBcILL72vOPefSy/PBe5ZmHqh1v2vC/3SKDemliYWNqJRDe8fujuXaFcO1q4afti06nFbVvYv/9fK/T1LpGH8vLAEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"b258335ee2f153e4\"\n        title=\"b258335ee2f153e4\"\n        src=\"/static/f0e2af9f3e1ec6eaaed1c2ede02ee315/1d69c/b258335ee2f153e4.png\"\n        srcset=\"/static/f0e2af9f3e1ec6eaaed1c2ede02ee315/4dcb9/b258335ee2f153e4.png 188w,\n/static/f0e2af9f3e1ec6eaaed1c2ede02ee315/5ff7e/b258335ee2f153e4.png 375w,\n/static/f0e2af9f3e1ec6eaaed1c2ede02ee315/1d69c/b258335ee2f153e4.png 750w,\n/static/f0e2af9f3e1ec6eaaed1c2ede02ee315/fbf08/b258335ee2f153e4.png 962w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p class=\"para\">整个过程最关键的是站点的CSS属性，而最后呈现的效果就像Cookie一样，所以成之为”<strong>CSS Cookies</strong>”。只有彻底清除浏览器缓存才能干掉这个“Cookie”。</p>\n<h2 class=\"heading subtitle heading\" id=\"为什么要用CSS来追踪用户\" style=\"position:relative;\"><a href=\"#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8CSS%E6%9D%A5%E8%BF%BD%E8%B8%AA%E7%94%A8%E6%88%B7\" aria-label=\"为什么要用CSS来追踪用户 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>为什么要用CSS来追踪用户？</h2>\n<p class=\"para\">通常网站使用Cookies来实现用户追踪。但是很容易就被拦截，比如停用JavaScript或者使用浏览器插件阻止。CSS的方案可以巧妙的绕过这些阻碍。因为整个过程中都没有用到JavaScript或者Cookie。</p>\n<p class=\"para\">目前这种方案的拓展性还是不够强，因为开发者需要定制大量的样式，浏览器需要下载更多CSS，发送更多请求。不过在 CSS 4 的草案中，CSS 的属性值支持变量计算。利用变量计算动态创建url的值，可以大幅降低请求的数量。</p>\n<deckgo-highlight-code language=\"sass\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">.body {\n  --unique-identifier: &#39;foo&#39; // unique generated ID\n  --pointer: &#39;none&#39;\n  --theme-preference: &#39;none&#39;\n  \n  // Only make one request\n  background-image: url(&quot;/some/url/?&quot; + var(--unique-identifier) + &quot;&amp;&quot; + var(--pointer) + &quot;&amp;&quot; + var(--theme-preference))\n}\n\n// Detect pointer type and theme\n@media (any-pointer: coarse){\n  body {\n    --pointer: &#39;coarse&#39;\n  }\n}\n\n@media (prefers-color-scheme: dark) {\n  body {\n    --theme-preference: &#39;dark&#39;\n  }\n}</code>\n        </deckgo-highlight-code>\n<p class=\"para\">利用草案提到的能力，不但可以提高这种方法的可扩展性，而且还将提高其精度。 目前很难将每个请求关联到某一个特定的访问用户，因为确定其来源的唯一可行方法是按照来源IP 地址对请求进行分组。 使用新草案，通过生成随机字符串并将其插入到每个访问者的 URL 标记中，可以准确地识别来自该访问者的所有请求。</p>\n<p class=\"para\">不得不说这种思路很巧妙。不过也许有人质疑这种方式是否道德，正如<a href=\"https://github.com/OliverBrotchie/CSS-Fingerprint/issues/3\" class=\"link-underline\">A fundamental question #3</a>，虽然目前各大浏览器厂商都没有限制这种方式。除了道理问题之外，还有安全问题。如果站点引用的包含恶意代码的第三方CSS文件，恶意代码可以通过这种方式收集信息，甚至发起XSS攻击。</p>\n<p class=\"para\">项目作者说自己创建这个项目主要是用于研究，同时希望能够让这个问题被更多人关注。截至到目前为止（2022年1月26日），作者称曾将这个问题反馈给 Firefox 和 Chromium，但是目前没有任何举措来解决这个问题。而W3C那边的答复是用户无法选择是否运行CSS，CSS 本质上是不安全的，不应该执行不受信任的CSS样式。</p>\n<h2 class=\"heading subtitle heading\" id=\"延伸如何确保资源是受信任的\" style=\"position:relative;\"><a href=\"#%E5%BB%B6%E4%BC%B8%E5%A6%82%E4%BD%95%E7%A1%AE%E4%BF%9D%E8%B5%84%E6%BA%90%E6%98%AF%E5%8F%97%E4%BF%A1%E4%BB%BB%E7%9A%84\" aria-label=\"延伸如何确保资源是受信任的 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>延伸：如何确保资源是受信任的？</h2>\n<p class=\"para\">如果用户无法决定是否运行CSS，那应该如何保证加载的CSS是受信任的呢？可以使用 **内容安全策略（Content Security Policy）**来限制站点加载的资源。</p>\n<p class=\"para\">CSP 是一个额外的安全层，用于检测并削弱某些特定类型的攻击，包括跨站脚本和数据注入攻击等。无论是数据盗取、网站内容污染还是散发恶意软件，这些攻击都是主要的手段。</p>\n<p class=\"para\">CSP 通过告诉浏览器一系列规则，严格规定页面中哪些资源允许有哪些来源， 不在指定范围内的统统拒绝。作为一种终极防护形式，CSP甚至可以在禁止JavaScript执行。</p>\n<p class=\"para\">实施有两种途径：</p>\n<ul>\n<li>\n<p class=\"para\">服务器添加 <code>Content-Security-Policy</code> 响应头来指定规则</p>\n</li>\n<li>\n<p class=\"para\">HTML 中添加 标签来指定 <code>Content-Security-Policy</code> 规则</p>\n</li>\n</ul>\n<h3 class=\"heading\" id=\"常见案例\" style=\"position:relative;\"><a href=\"#%E5%B8%B8%E8%A7%81%E6%A1%88%E4%BE%8B\" aria-label=\"常见案例 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>常见案例</h3>\n<ul>\n<li>想要所有内容均来自站点的同一个源 (不包括其子域名)</li>\n</ul>\n<deckgo-highlight-code language=\"plaintext\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">Content-Security-Policy: default-src &#39;self&#39;</code>\n        </deckgo-highlight-code>\n<ul>\n<li>允许内容来自信任的域名及其子域名 (域名不必须与CSP设置所在的域名相同)</li>\n</ul>\n<deckgo-highlight-code language=\"plaintext\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">Content-Security-Policy: default-src &#39;self&#39; *.trusted.com</code>\n        </deckgo-highlight-code>\n<ul>\n<li>允许网页应用的用户在他们自己的内容中包含来自任何源的图片, 但是限制音频或视频需从信任的资源提供者(获得)，所有脚本必须从特定主机服务器获取可信的代码.</li>\n</ul>\n<deckgo-highlight-code language=\"plaintext\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">Content-Security-Policy: default-src &#39;self&#39;; img-src *; media-src media1.com media2.com; script-src userscripts.example.com</code>\n        </deckgo-highlight-code>\n<h2 class=\"heading subtitle heading\" id=\"延伸supercookies\" style=\"position:relative;\"><a href=\"#%E5%BB%B6%E4%BC%B8supercookies\" aria-label=\"延伸supercookies permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>延伸：supercookies</h2>\n<p class=\"para\">从这个项目中顺藤摸瓜发现了<a href=\"https://github.com/jonasstrehle/supercookie\" class=\"link-underline\">https://github.com/jonasstrehle/supercookie</a>，利用favicon 为用户分配一个唯一的身份信息。这个项目同样也是用于教学和研究（可能国外对用户信息比较敏感的关系？）。具体细节可以参阅：<a href=\"https://supercookie.me/workwise\" class=\"link-underline\">https://supercookie.me/workwise</a></p>\n<h2 class=\"heading subtitle heading\" id=\"结束语\" style=\"position:relative;\"><a href=\"#%E7%BB%93%E6%9D%9F%E8%AF%AD\" aria-label=\"结束语 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>结束语</h2>\n<p class=\"para\">使用CSS来追踪用户的确是一个有创意的想法，但是随之而来会带来道德问题和安全问题。这种追踪方案的整个过程都是全自动的。每当对应的CSS执行，数据就会上报到服务端。如果利用JavaScript 增加一个用户确认的步骤，选择性加载CSS，那么在用户禁用 JavaScript 的情况下将无法上报数据。对应延伸出的安全问题，其实是由来已久的问题，可以通过CSP的手段来加固我们的站点。</p>\n<h2 class=\"heading subtitle heading\" id=\"参考\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83\" aria-label=\"参考 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li>\n<p class=\"para\"><a href=\"https://github.com/OliverBrotchie/CSS-Fingerprint\" class=\"link-underline\">CSS-Fingerprint</a></p>\n</li>\n<li>\n<p class=\"para\"><a href=\"https://csstracking.dev/\" class=\"link-underline\">CSSTracking.dev</a></p>\n</li>\n<li>\n<p class=\"para\"><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CSP\" class=\"link-underline\">MDN-内容安全策略( CSP )</a></p>\n</li>\n</ul>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%E4%BD%BF%E7%94%A8-media-query-%E8%BF%BD%E8%B8%AA%E8%AE%BE%E5%A4%87%E7%89%B9%E5%BE%81\">使用 Media Query 追踪设备特征</a></p>\n</li>\n<li>\n<p><a href=\"#%E4%BD%BF%E7%94%A8font-face%E6%A3%80%E6%B5%8B%E5%AD%97%E4%BD%93%E5%AE%89%E8%A3%85\">使用font-face检测字体安装</a></p>\n</li>\n<li>\n<p><a href=\"#%E5%88%A9%E7%94%A8%E9%87%8D%E5%AE%9A%E5%90%91%E5%88%9B%E9%80%A0-css-cookies\">利用重定向创造 CSS Cookies</a></p>\n</li>\n<li>\n<p><a href=\"#%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8css%E6%9D%A5%E8%BF%BD%E8%B8%AA%E7%94%A8%E6%88%B7\">为什么要用CSS来追踪用户？</a></p>\n</li>\n<li>\n<p><a href=\"#%E5%BB%B6%E4%BC%B8%E5%A6%82%E4%BD%95%E7%A1%AE%E4%BF%9D%E8%B5%84%E6%BA%90%E6%98%AF%E5%8F%97%E4%BF%A1%E4%BB%BB%E7%9A%84\">延伸：如何确保资源是受信任的？</a></p>\n<ul>\n<li><a href=\"#%E5%B8%B8%E8%A7%81%E6%A1%88%E4%BE%8B\">常见案例</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E5%BB%B6%E4%BC%B8supercookies\">延伸：supercookies</a></p>\n</li>\n<li>\n<p><a href=\"#%E7%BB%93%E6%9D%9F%E8%AF%AD\">结束语</a></p>\n</li>\n<li>\n<p><a href=\"#%E5%8F%82%E8%80%83\">参考</a></p>\n</li>\n</ul>","headings":[{"id":"使用-Media-Query-追踪设备特征","depth":2,"value":"使用 Media Query 追踪设备特征"},{"id":"使用font-face检测字体安装","depth":2,"value":"使用font-face检测字体安装"},{"id":"利用重定向创造-CSS-Cookies","depth":2,"value":"利用重定向创造 CSS Cookies"},{"id":"为什么要用CSS来追踪用户","depth":2,"value":"为什么要用CSS来追踪用户？"},{"id":"延伸如何确保资源是受信任的","depth":2,"value":"延伸：如何确保资源是受信任的？"},{"id":"常见案例","depth":3,"value":"常见案例"},{"id":"延伸supercookies","depth":2,"value":"延伸：supercookies"},{"id":"结束语","depth":2,"value":"结束语"},{"id":"参考","depth":2,"value":"参考"}],"frontmatter":{"title":"使用CSS追踪用户信息-CSS Fingerpoint","date":"2022-01-11","cover":"https://www.notion.so/images/page-cover/woodcuts_13.jpg","description":null,"categories":["技术应用"],"tags":["CSS"]}},"previous":{"fields":{"slug":"/blogs/《架构师修炼之道》摘录07-架构模式/"},"frontmatter":{"title":"《架构师修炼之道》摘录07-架构模式"}},"next":{"fields":{"slug":"/blogs/《架构师修炼之道》摘录06-主动选择架构/"},"frontmatter":{"title":"《架构师修炼之道》摘录06-主动选择架构","tags":["笔记","架构"],"categories":["解决方案"],"status":"publish"}}},"pageContext":{"id":"ffcae36c-60a9-514c-b176-bb27bb714b90","previousPostId":"37e4b759-5048-5ba0-aa0c-d2e6e3262efa","nextPostId":"c0179405-fb67-5a17-a866-497ba91bf9ad"}},
    "staticQueryHashes": ["2841359383"]}