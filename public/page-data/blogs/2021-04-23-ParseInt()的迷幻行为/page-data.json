{
    "componentChunkName": "component---src-templates-blog-post-tsx",
    "path": "/blogs/2021-04-23-ParseInt()的迷幻行为/",
    "result": {"data":{"site":{"siteMetadata":{"title":"张小伦的网络日志","description":"欢迎来到张小伦的网络日志 \n\t\t一个记录生活，分享心得的博客","menu":[{"id":"home","name":"首页","url":"/"},{"id":"blog","name":"博文","url":"/blogs"},{"id":"category","name":"分类","url":"/categories"},{"id":"archive","name":"归档","url":"/archives"},{"id":"lab","name":"实验室","url":"/labs"},{"id":"about","name":"关于我","url":"/about"}]}},"markdownRemark":{"id":"e3d68767-ea0a-5e8e-b97a-870c83e23193","html":"<p class=\"para\">最近看到一片文章 <a href=\"%5Bhttps://dmitripavlutin.com/parseint-mystery-javascript/%5D(https://dmitripavlutin.com/parseint-mystery-javascript/)\" class=\"link-underline\">Solving a Mystery Behavior of parseInt() in JavaScript</a>，讲的是JavaScript中的<code>parseInt()</code>的一个奇怪现象。</p>\n<p class=\"para\"><code>parseInt()</code>是JavaScript内置的一个方法，能将数字型的字符串转换成整数。例如， 将 <code>'100'</code>转换成<code>100</code></p>\n<deckgo-highlight-code language=\"js\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">const number = parseInt(&#39;100&#39;);\nconsole.log(number); // 100</code>\n        </deckgo-highlight-code>\n<p class=\"para\"><code>parseInt(numbericalString, radix)</code>也可以接受第二个参数，解析一个字符串并返回指定基数的十进制整数， <code>radix</code> 是2-36之间的整数，表示被解析字符串的基数，常用的是2，8，10和16。例如</p>\n<deckgo-highlight-code language=\"js\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">const number = parseInt(&#39;100&#39;, 2);\nconsole.log(number); // 4\n\nconst number = parseInt(&#39;100&#39;, 8);\nconsole.log(number); // 64</code>\n        </deckgo-highlight-code>\n<p class=\"para\">以上是<code>parseInt()</code>的基本用法。</p>\n<h2 class=\"heading subtitle heading\" id=\"parseInt的一个奇怪行为\" style=\"position:relative;\"><a href=\"#parseInt%E7%9A%84%E4%B8%80%E4%B8%AA%E5%A5%87%E6%80%AA%E8%A1%8C%E4%B8%BA\" aria-label=\"parseInt的一个奇怪行为 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>parseInt()的一个奇怪行为</h2>\n<p class=\"para\"><code> praseInt(numbericalString)</code> 会将其第一个参数转换为一个字符串，对该字符串进行解析，然后返回一个整数或 NaN，所以我们可以用 <code>parseInt()</code> 方法来获取浮点数的整数。</p>\n<deckgo-highlight-code language=\"js\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">parseInt(0.5);      // =&gt; 0\nparseInt(0.05);     // =&gt; 0\nparseInt(0.005);    // =&gt; 0\nparseInt(0.0005);   // =&gt; 0\nparseInt(0.00005);  // =&gt; 0\nparseInt(0.000005); // =&gt; 0</code>\n        </deckgo-highlight-code>\n<p class=\"para\">获取0.5，0.05这样的浮点数的整数返回<code>0</code>，这看起来没有任何问题。但是 <code>parseInt()</code> 会讲<code>0.0000005</code> 转换成5。</p>\n<deckgo-highlight-code language=\"js\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">parseInt(0.0000005); // 5</code>\n        </deckgo-highlight-code>\n<p class=\"para\">这到底是为什么呢？</p>\n<h2 class=\"heading subtitle heading\" id=\"解开谜团\" style=\"position:relative;\"><a href=\"#%E8%A7%A3%E5%BC%80%E8%B0%9C%E5%9B%A2\" aria-label=\"解开谜团 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>解开谜团</h2>\n<p class=\"para\">前面提到 <code>parseInt</code> 执行时，会先将第一个参数转换成字符串(<a href=\"https://262.ecma-international.org/5.1/#sec-15.1.2.2\" class=\"link-underline\">ECMASCript ParseInt()</a>)。其具体步骤如下，</p>\n<ol>\n<li>声明<code>inputString</code> = String(string)。</li>\n<li>声明 <code>S</code>, 保存去掉 <code>inputString</code> 开头的空格之后的字符串，如果 <code>inputString</code> 是空字符串则返回空字符串。</li>\n<li>声明标记位 <code>sign</code> = 1。</li>\n<li>如果<code>S</code>不为空且第一个字符是减号<code>-</code>，<code>sign</code>设置为<code>-1</code>。</li>\n<li>如果<code>S</code>不为空且第一个字符是加号<code>+</code>或者减号<code>-</code>，移除第一个字符串。</li>\n<li>声明<code>R=ToInt32(radix)</code>。</li>\n<li>声明<code>stripPrefix = true</code>。</li>\n<li>如果 R !== 0，则</li>\n</ol>\n<ul>\n<li>a. 如果R &#x3C; 2 或者 R > 36，返回NaN。</li>\n<li>b. 如果 R !== 16，设置<code>stripPrefix = false</code>。</li>\n</ul>\n<ol start=\"9\">\n<li>如果 R == 0</li>\n</ol>\n<ul>\n<li>a. 设置 R = 10</li>\n</ul>\n<ol start=\"10\">\n<li>如果 stripPrefix === true</li>\n</ol>\n<ul>\n<li>a. 如果S的长度大于2且前两个字符是<code>0x</code>或者<code>0X</code>，移除前两个字符，同时设置R = 16</li>\n</ul>\n<ol start=\"11\">\n<li>如果S包含了当前R进制不相关的字符（假定第一个这样的字符是Q)，设置Z为S的一个子字符串，这个子字符串是Q之前的所有字符。否则设置Z=S</li>\n<li>如果 <code>Z</code> 为空，返回 <code>NaN</code></li>\n<li>声明 <code>mathInt</code> 为Z在当前R进制下的整数</li>\n<li>声明 <code>number</code> 为 <code>mathInt</code></li>\n<li>返回 <code>sign x number</code></li>\n</ol>\n<p class=\"para\">那我们先用 <code>String()</code> 来测试</p>\n<deckgo-highlight-code language=\"js\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">String(0.5);      // =&gt; &#39;0.5&#39;\nString(0.05);     // =&gt; &#39;0.05&#39;\nString(0.005);    // =&gt; &#39;0.05&#39;\nString(0.0005);   // =&gt; &#39;0.005&#39; \nString(0.00005);  // =&gt; &#39;0.00005&#39;\nString(0.000005); // =&gt; &#39;0.000005&#39;\n\nString(0.0000005); // =&gt; &#39;5e-7&#39;</code>\n        </deckgo-highlight-code>\n<p class=\"para\">可以看到<code>String(0.0000005)</code>返回了科学计数法的格式<code>5e-7</code>，那么按照上面提到的 <code>parseInt()</code> 的实际处理过程，确实是返回<code>5</code>。由于某些数字在其字符串表示形式中使用e字符（例如 6.022×23 表示 6.022e23 ），因此当对非常大或非常小的数字使用数字时，使用 <code>parseInt</code> 截断数字将产生意外结果。</p>\n<p class=\"para\">将浮点数转换成整数的另一个更加安全的是 <code>Math.floor()</code></p>\n<deckgo-highlight-code language=\"js\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">Math.floor(0.5);      // =&gt; 0\nMath.floor(0.05);     // =&gt; 0\nMath.floor(0.005);    // =&gt; 0\nMath.floor(0.0005);   // =&gt; 0\nMath.floor(0.00005);  // =&gt; 0\nMath.floor(0.000005); // =&gt; 0\n\nMath.floor(0.0000005); // =&gt; 0</code>\n        </deckgo-highlight-code>\n<p class=\"para\">那 parseInt(999999999999999999999) 返回多少呢？</p>\n<h2 class=\"heading subtitle heading\" id=\"参考文章\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0\" aria-label=\"参考文章 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考文章</h2>\n<ol>\n<li><a href=\"https://dmitripavlutin.com/parseint-mystery-javascript/\" class=\"link-underline\">Solving a Mystery Behavior of parseInt() in JavaScript</a></li>\n<li><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/parseInt\" class=\"link-underline\">MDN ParseInt</a></li>\n<li><a href=\"https://262.ecma-international.org/5.1/#sec-15.1.2.2\" class=\"link-underline\">ECMASCript ParseInt()</a></li>\n</ol>","tableOfContents":"<ul>\n<li><a href=\"#parseint%E7%9A%84%E4%B8%80%E4%B8%AA%E5%A5%87%E6%80%AA%E8%A1%8C%E4%B8%BA\">parseInt()的一个奇怪行为</a></li>\n<li><a href=\"#%E8%A7%A3%E5%BC%80%E8%B0%9C%E5%9B%A2\">解开谜团</a></li>\n<li><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0\">参考文章</a></li>\n</ul>","headings":[{"id":"parseInt的一个奇怪行为","depth":2,"value":"parseInt()的一个奇怪行为"},{"id":"解开谜团","depth":2,"value":"解开谜团"},{"id":"参考文章","depth":2,"value":"参考文章"}],"frontmatter":{"title":"ParseInt()的迷幻行为","date":"2021-04-23","cover":null,"description":null,"categories":["技术研究"],"tags":["Javascript"]}},"previous":{"fields":{"slug":"/blogs/asdfasdf/"},"frontmatter":{"title":"《架构修炼师之道》摘录01-成为软件架构师"}},"next":{"fields":{"slug":"/blogs/劝架CommonJS和ESModule/"},"frontmatter":{"title":"劝架CommonJS和ESModule","tags":["JavaScrtipt","Node.js"],"categories":["技术研究"],"status":"publish"}}},"pageContext":{"id":"e3d68767-ea0a-5e8e-b97a-870c83e23193","previousPostId":"44af9d7b-978b-5e08-87f8-8abd57c51458","nextPostId":"b0164ce6-c940-5a43-bb5e-cba2e13310fb"}},
    "staticQueryHashes": ["2841359383"]}