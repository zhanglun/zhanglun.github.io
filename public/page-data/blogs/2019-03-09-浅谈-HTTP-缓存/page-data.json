{
    "componentChunkName": "component---src-templates-blog-post-tsx",
    "path": "/blogs/2019-03-09-浅谈-HTTP-缓存/",
    "result": {"data":{"site":{"siteMetadata":{"title":"张小伦的网络日志","description":"欢迎来到张小伦的网络日志 \n\t\t一个记录生活，分享心得的博客","menu":[{"id":"home","name":"首页","url":"/"},{"id":"blog","name":"博文","url":"/blogs"},{"id":"category","name":"分类","url":"/categories"},{"id":"archive","name":"归档","url":"/archives"},{"id":"lab","name":"实验室","url":"/labs"},{"id":"about","name":"关于我","url":"/about"}]}},"markdownRemark":{"id":"e684b29e-a44d-5534-8d03-2980ca03d355","html":"<p class=\"para\">说到缓存大家可能觉得很简单。“不就是检查资源是否有缓存，如果有就加以利用”，“可以节约服务器资源呗”。如果再深入一点，有的cache-control, last-modified, etag 之类的名词，但如果真的考究一下这些字段的细节，恐怕大多数人也说不清楚。遂做了一番整理，希望对大家有所帮助</p>\n<!--more-->\n<h2 class=\"heading subtitle heading\" id=\"HTTP-缓存\" style=\"position:relative;\"><a href=\"#HTTP-%E7%BC%93%E5%AD%98\" aria-label=\"HTTP 缓存 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>HTTP 缓存</h2>\n<p class=\"para\">HTTP 缓存是一种保存资源副本并在下次请求时直接使用该副本的技术。最为常见的是，浏览器在本地缓存 HTML 页面、图片等静态资源文件静态文件。</p>\n<blockquote class=\"quote\">\n<p class=\"para\">A HTTP cache is an information technology for the temporary storage (caching) of web documents, such as HTML pages and images, to reduce server lag. A web cache system stores copies of documents passing through it; subsequent requests may be satisfied from the cache if certain conditions are met. A web cache system can refer either to an appliance, or to a computer program.\n摘自 Wiki百科 <a href=\"https://www.wikiwand.com/en/Web_cache\" class=\"link-underline\">Web cache - Wikiwand</a></p>\n</blockquote>\n<p class=\"para\">合理利用缓存可以实现：</p>\n<ol>\n<li>减少冗余数据的传输，节约网络费用</li>\n<li>缓解了网络瓶颈的问题，节约带宽</li>\n<li>降低服务器压力，服务器可以更快的响应</li>\n<li>减少网络延迟，提升站点的访问速度</li>\n</ol>\n<p class=\"para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 508px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cc0bd3461d2bf5d74d186b9346754f15/2fd48/1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.72340425531915%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABzklEQVQoz31Sy47TQBD0RyNx5IYQH8Bt4cCNExJ7Qoq0HFbhwkIikjireMkmtuPHzPgdJ3HiQtXsRJFAjNSye7q7pqq7HWMMfN+H53lIkgRlWaJtW2y32/9aXddQSiGKIriui81mA2I5DBJwNBqhqipkWYaiKJDnuRj9S7P3cRwLIEGGwyG01nLvEMSe4/GIMAwlmYk0gtgvjYUEohLeXx5hSOo8fd9jv99LEYFpu91OWNtv0zTnGO2fgGeGfY9d2+KSMaWnSYLvd3fIjBFmp9PpHGfP2fvJZIIgCMR3mm17TuhOEElkxMHwn+V5tZW4HVjXdTgcDtKe2WyGwWCA1WolA3Li0Ed0/w2b2VeEv1wobaSQ0oMgROp76PQSZbyU3pI1Y2RDQD5Kn+zTNIXz+OMGyacXePzwHOGXt1iFMTKjpV9MuP/4Cj/fP4N//RLL+RhKczhGVocyF4sFptOpSOcDTuSNYW7fIRi8gRp/RpRoVE/S+Gpwc4Xl9WsUt1fwH1wUZSV9ZpwA6/Ua8/lcwLmLjlJ/AKoyh9L6r6FkRmFf52jrUh7gNthj18uuFn2naWrUTSMSCcZm2yLKMlz0skKeF9JbxmycLLl21uj/BtKHPafmUCEGAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"59818e08.png\"\n        title=\"59818e08.png\"\n        src=\"/static/cc0bd3461d2bf5d74d186b9346754f15/2fd48/1.png\"\n        srcset=\"/static/cc0bd3461d2bf5d74d186b9346754f15/4dcb9/1.png 188w,\n/static/cc0bd3461d2bf5d74d186b9346754f15/5ff7e/1.png 375w,\n/static/cc0bd3461d2bf5d74d186b9346754f15/2fd48/1.png 508w\"\n        sizes=\"(max-width: 508px) 100vw, 508px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p class=\"para\">如图所示HTTP缓存存在于浏览器和Web代理中。当然在服务器内部，也存在着各种缓存，比如本地缓存GuavaCache/Ehcache，分布式缓存Memcached/Redis等，但这不是本文要讨论的HTTP缓存。</p>\n<p class=\"para\"><strong>为了方便描述，下文将用“缓存”代替“HTTP 缓存”</strong></p>\n<h2 class=\"heading subtitle heading\" id=\"缓存的分类\" style=\"position:relative;\"><a href=\"#%E7%BC%93%E5%AD%98%E7%9A%84%E5%88%86%E7%B1%BB\" aria-label=\"缓存的分类 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>缓存的分类</h2>\n<p class=\"para\">在我看来，无论按照什么场景或者维度来划分，HTTP缓存本质上就是两类：客户端缓存和服务端缓存。</p>\n<p class=\"para\">为什么这么说呢？因为在两台计算机之间使用HTTP协议通信时，在一条通信线路上，必定一端是客户端，一端是服务端。</p>\n<p class=\"para\">HTTP协议规定，请求从客户端发出，最后服务端响应。换言之，HTTP协议是能够明显区分哪一端是客户端，哪一段是服务端的。</p>\n<p class=\"para\">像 <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Caching_FAQ#%E5%90%84%E7%A7%8D%E7%B1%BB%E5%9E%8B%E7%9A%84%E7%BC%93%E5%AD%98\" class=\"link-underline\">MDN文章：HTTP 缓存 - HTTP | MDN</a> 中提到的私有缓存和共享缓存是从网络的拓扑结构层面来解释。</p>\n<p class=\"para\">至于网上大部分博文中提到的“强缓存”， “协商缓存”，我没有在任何文档中找到这两个关键词的定义，如果有知道的同学，欢迎留言。</p>\n<p class=\"para\">由于前端开发人员多与浏览器打交道，所以日常工作中大多时候会用 “浏览器缓存”来代替“客户端缓存”，这一点无伤大雅。</p>\n<h2 class=\"heading subtitle heading\" id=\"HTTP-的简单介绍\" style=\"position:relative;\"><a href=\"#HTTP-%E7%9A%84%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D\" aria-label=\"HTTP 的简单介绍 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>HTTP 的简单介绍</h2>\n<p class=\"para\">在具体解释HTTP首部字段对缓存的控制规则之前，简单介绍一些与 HTTP 协议有关的内容，作为后续内容的铺垫。</p>\n<h3 class=\"heading\" id=\"HTTP-协议\" style=\"position:relative;\"><a href=\"#HTTP-%E5%8D%8F%E8%AE%AE\" aria-label=\"HTTP 协议 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>HTTP 协议</h3>\n<blockquote class=\"quote\">\n<p class=\"para\">HTTP协议是 Hyper Text Transfer Protocol（超文本传输协议）的缩写,是用于从万维网（WWW:World Wide Web ）服务器传输超文本到客户端的传送协议。</p>\n</blockquote>\n<h3 class=\"heading\" id=\"HTTP-报文\" style=\"position:relative;\"><a href=\"#HTTP-%E6%8A%A5%E6%96%87\" aria-label=\"HTTP 报文 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>HTTP 报文</h3>\n<p class=\"para\">HTTP 报文是HTTP协议传输的数据单元，即一次请求或者一次响应时，发送给对方的数据块。HTPP报文包含了将要发送的完整的数据信息。</p>\n<p class=\"para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a1c4fb0278b91555593ca4111766ee21/bb051/2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.57446808510639%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABQklEQVQoz31QW8uCUBD0//8FK4iwB7OoEH1IehApumA3NDLQikAxjbILvdjELhjxPXwLw549nJmzM4LjOFitVozZbIbFYgHXdfnseR622y3oTRAEuN1uuF6v3Avc73c8Hg9kWcZdmE6nGI/HME0T3W4Xuq6D7gaDAebzOfb7PQsfj0ecTqdvD8MQURQhSRKkacpzHMcQ2u02JEmCKIoolUool8uo1+uoVqvo9/sscDgcmEBbvF4vnM9nPJ9PnkmMtqaZSjAMA6qqotPpQFEUtFotaJqGZrOJ4XCIy+XCYrQp2SbQ7Ps+x0GfkW0SfL/fEHq9Hos1Gg1UKhXUajW2Lssyx7Db7ZhMRNqOSFR5njN+iwWXyyVvMhqNOLvJZMKwLAubzeabIYEyKoh/hYo7Af9UYY9yXK/XsG2bbf6KFELF+QMkn/giAtxpzwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"57450782.png\"\n        title=\"57450782.png\"\n        src=\"/static/a1c4fb0278b91555593ca4111766ee21/1d69c/2.png\"\n        srcset=\"/static/a1c4fb0278b91555593ca4111766ee21/4dcb9/2.png 188w,\n/static/a1c4fb0278b91555593ca4111766ee21/5ff7e/2.png 375w,\n/static/a1c4fb0278b91555593ca4111766ee21/1d69c/2.png 750w,\n/static/a1c4fb0278b91555593ca4111766ee21/78797/2.png 1125w,\n/static/a1c4fb0278b91555593ca4111766ee21/bb051/2.png 1212w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p class=\"para\">HTTP 报文分为<strong>请求报文</strong>和<strong>响应报文</strong>。</p>\n<p class=\"para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 709px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d1a8fdbc16d69a472daa174b0f9c73f8/4d08a/3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.57446808510639%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABJ0lEQVQoz02R6a6CUAyEz/u/BD+MIXE3GlRccAV3g0oA8V3m5muCuT8mp03bmU6PW61WCoJA4/FYYRjqfD7rcrkYrter5eB+vxsej8cPz+dTr9dLt9tNs9lMp9NJbr1eGyFkkJIfj0dtNhuLkyTRdrvV4XAwYmq73c5yCMiJEWcJR7HX62mxWKjb7RopGAwGGg6Hmk6nFk8mE+tBKIoi4YxZCOM4/gk4iv1+35ohWC6Xtu18Pjfi/X5vjdjCXpZlhjzPVRSFPp+PyrK0OE1TOZjZADWscQtsciOG3u+3vfVQTUT+/X7tBVVVmaDDkud5arVa8n3/Z3U0GpkIFhFiU8QBFhHlpizAbLvdtr9w2Go0Gmo2m1bAPjcFxDXIO52Ooa797+Plzn9OwceVoWL1yAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2a108fe1.png\"\n        title=\"2a108fe1.png\"\n        src=\"/static/d1a8fdbc16d69a472daa174b0f9c73f8/4d08a/3.png\"\n        srcset=\"/static/d1a8fdbc16d69a472daa174b0f9c73f8/4dcb9/3.png 188w,\n/static/d1a8fdbc16d69a472daa174b0f9c73f8/5ff7e/3.png 375w,\n/static/d1a8fdbc16d69a472daa174b0f9c73f8/4d08a/3.png 709w\"\n        sizes=\"(max-width: 709px) 100vw, 709px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p class=\"para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 713px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9f360c29e6f47acdcf40fb50785b67ed/01267/4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.446808510638306%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABkklEQVQoz1WSx8oCQAyE9/3PHjyIKGLvvSv2ir2LzzI/X2DF/zBkSzKZya4bDodqtVrq9/tqNBqaTCZaLpeG9Xr9XR8OBx2PR51Op288n8+6Xq/abDZWz941m01Vq1UjJXIxHo81Go00GAxsDyAHu93uHzkkvgnnrt1uG1GpVFKxWFSn01Gv1xONiKvVyhQuFgvNZjPt93tTdbvdDPf73faXy8WIHSogq9VqRohSSL0KEr01T/B4PPR6vfR8PvX5fPR+v21PrsMehBB1u12hGLso8d1/iSChGEA0n89tNNRst1u5RCKhUCikcDisaDSqTCYjzlKplAqFgrLZrNLptEX2uEBAuVxWpVKxfO4BI3IkRCIRu8jn81ZIBLlczohBMpk0MmaLG4AbXHnwQxzdUEcBykA8HrcGEKIKsIaQRv4RvWKUQs6jmcJgMPhV4AmwxL+s1+umivWvMh+B/xnT6VSO4kAg8LXs54UimgBvnehBHgL4HZ6QB3bI51GwgBISAOd+DVCKSj/D31nSNBaL2aP8AdzBvQX8L8RiAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"20394b00.png\"\n        title=\"20394b00.png\"\n        src=\"/static/9f360c29e6f47acdcf40fb50785b67ed/01267/4.png\"\n        srcset=\"/static/9f360c29e6f47acdcf40fb50785b67ed/4dcb9/4.png 188w,\n/static/9f360c29e6f47acdcf40fb50785b67ed/5ff7e/4.png 375w,\n/static/9f360c29e6f47acdcf40fb50785b67ed/01267/4.png 713w\"\n        sizes=\"(max-width: 713px) 100vw, 713px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p class=\"para\">请求报文和响应报文中必定包含 HTTP 首部，为客户端和服务端分别处理请求和响应提供所需要的信息。首部字段类型按照实际用途分为四种：</p>\n<ol>\n<li>通用首部字段 (General Heaer Fields) - 请求报文和响应报文双方都会使用的首部</li>\n<li>请求首部字段 (Request Header Fields) - 发送请求报文时使用的首部</li>\n<li>响应首部字段 (Resposne Header Fields) - 返回响应报文时使用的首部</li>\n<li>实体首部字段 (Entity Header Fields) - 报文实体部分使用的首部</li>\n</ol>\n<p class=\"para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 714px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4676810d19234646bd9dc3cb6489543d/d67ca/5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.191489361702125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0UlEQVQoz01Sh6pqMRDM//+FvYu9i4qCvaFib2BBRRTFrsxjFnJ5geHsSTa7szNRy+US8/kcw+EQk8kEi8UC3GN8vV7xeDzwer1wOBwwnU4xm83kvN1uo16vSz7vE6vVCqrZbKJSqSASiSAcDqNWq6Hb7aJYLOJ+v0OvzWaDcrmMRqOBXC4Hl8slSCaTYA2C95TH44HBYIDZbIbNZoPdbgf3vF4vTqcTPp/PX0E2YcFoNAqLxQKn0wmfzydMNREVCoUQDAYlwWQySUymfr8ft9sN7/dbwJEHg4GMzXFTqRTi8Tiq1arIoKFisZjQ5peFmEik0+m/kanh5XKRf60p/3e7ncTcez6fQkDRDKLX66Hf72M8HgsLxjSFFzj28XiUfYIGkCV104aQHQ1S2i2OToZMYgPqxY567fd7GY8a5vN5uN1uOBwOJBIJudNqteSrqBUNoX5Wq1WEpuOBQADn8xnf71cKcrxSqSQFWYT5LEjzaAhBYoqHZGc0GsVtmkJN2Yg6aY3+N4Vuat21Kfotq0KhACKTySCbzcqo7EQ2dFcv7TaLkzUN2m63YoY2i5orCq7fGhM6nY40YHHqxj3GfMw8W6/XGI1GwpAxF+//fj/BP7IT/+BdI/jvAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"7c478d42.png\"\n        title=\"7c478d42.png\"\n        src=\"/static/4676810d19234646bd9dc3cb6489543d/d67ca/5.png\"\n        srcset=\"/static/4676810d19234646bd9dc3cb6489543d/4dcb9/5.png 188w,\n/static/4676810d19234646bd9dc3cb6489543d/5ff7e/5.png 375w,\n/static/4676810d19234646bd9dc3cb6489543d/d67ca/5.png 714w\"\n        sizes=\"(max-width: 714px) 100vw, 714px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p class=\"para\">开发者工具中的 Network选项中，可以查看请求的具体信息\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d5274665bfce38ddb61b1bdbd5993694/0eb6d/6.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.97872340425533%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsTAAALEwEAmpwYAAABfElEQVQ4y52S627jIBCFef/325+b1ImN8RUbzG0AnyqkrRJ1t6oz0idGoBkd5gz786ZQNwNEK9C2HZqGo6k5Wi7AuUBVXVDXvORSLlhXBec8vA//hFVvZ1x5jWmUmCcJpTSsddg2W05jbOF+Z0r+v2al4ak+4684YZEr5lliWVZotWFdNUKgJ4giiOjb/SOs4QOGTsJsFjEmxFtRjIjxXnwUVnUeV2Eheg+jApAy9n1/GTZOhGVL2HRE9hG3uD28GqzuA4bWIkv79PCywnny8NcVoVYIXIF6gz3lb81/rbATDqZaQEKDOo3QakRpkS0hbQF7zIeaMje5r+9+Fu15f+LICNilCxiFRdK+qCo4QjKhcNQg1s4Jc++RRgMaDaJ0haRDmeVhUxo+YzoJqMsE1yp4aUGbBxkPsqEseFn4r/Nn2Lnz4K2BvS6gXpddfOSwQjFEeO6Qeo/s0see3I3Bgym/nuGyRpAi5E9cQt7iPdcRu0/HXP4Q9GMcWex3DvE1O6W7dQ4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"a4104786.png\"\n        title=\"a4104786.png\"\n        src=\"/static/d5274665bfce38ddb61b1bdbd5993694/1d69c/6.png\"\n        srcset=\"/static/d5274665bfce38ddb61b1bdbd5993694/4dcb9/6.png 188w,\n/static/d5274665bfce38ddb61b1bdbd5993694/5ff7e/6.png 375w,\n/static/d5274665bfce38ddb61b1bdbd5993694/1d69c/6.png 750w,\n/static/d5274665bfce38ddb61b1bdbd5993694/0eb6d/6.png 913w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h2 class=\"heading subtitle heading\" id=\"缓存的工作机制\" style=\"position:relative;\"><a href=\"#%E7%BC%93%E5%AD%98%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%88%B6\" aria-label=\"缓存的工作机制 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>缓存的工作机制</h2>\n<p class=\"para\">对于一条GET请求的基本缓存处理过程包括七个步骤。</p>\n<ol>\n<li>发送 – 缓存从网络中读取即将的请求报文</li>\n<li>解析 – 缓存对报文进行解析，提取出URL和各种首部</li>\n<li>查询 – 缓存查看是否有本地副本可用，如果没有，就获取一份副本，并保存在本地</li>\n<li>新鲜度检测 – 缓存查看已缓存副本是否足够新鲜，如果不是，就询问服务器是否有任何更新</li>\n<li>创建响应 – 缓存会用新的首部和已缓存主体来构建一条响应报文</li>\n<li>返回 – 服务器通过网络将响应发回给客户端</li>\n</ol>\n<p class=\"para\">这里的缓存可以是本地客户端缓存，也可以是代理缓存之类的缓存服务器。服务器可能是源服务器也可能是缓存服务器、客户端可以能是浏览器也可能是缓存服务器</p>\n<h3 class=\"heading\" id=\"新鲜度检测和服务器再验证\" style=\"position:relative;\"><a href=\"#%E6%96%B0%E9%B2%9C%E5%BA%A6%E6%A3%80%E6%B5%8B%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%86%8D%E9%AA%8C%E8%AF%81\" aria-label=\"新鲜度检测和服务器再验证 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>新鲜度检测和服务器再验证</h3>\n<p class=\"para\">什么是新鲜度检测？要知道，不是所有的缓存副本都与服务器上的文档一致。毕竟，不同场景下，文档都有其变化的原则。比如说，一份报告可能每个月更新一次，在线报纸每天都有新的内容，而金融类的数据可能每过几秒钟就发生变化，如果缓存总是提供老的数据，反而变得毫无用处。</p>\n<p class=\"para\">文档副本在被缓存的一段时间内，都认为文档是“新鲜的”，缓存可以在不联系服务器的情况下，直接提供文档的副本，在客户端的体现为:<code>from cache</code>。当缓存的保留的时间过长，超过了限值，就认为文档“过时了”。在使用这个文档之前，缓存需要与服务端确认，文档是否发生变化，而这就是服务端再验证。</p>\n<p class=\"para\">HTTP 提供称之为<code>文档过期(document expiration)</code> 和 <code>服务器再验证(server revalidation)</code>的机制。可以在不要求服务器记住哪些文档拥有缓存的情况下，还能够了保证缓存与服务器之间的充分一致，</p>\n<p class=\"para\">下图是一个GET请求的缓存流程图</p>\n<p class=\"para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9e5694846c71c77ee5ec10277f629443/668c6/7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.57446808510638%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAAB3klEQVQoz52TUW8SQRSF99f6C3zwQRNN+qC8mTSxMYKJCab1oRJCTZP6UIxlweKCtVqgBYy1ICJQujsLM7Ozn9kFQkiMTb3JmZ25mT1z75kz1jRQPHWybHx8zYaTwZU+UYRhGOOmYU20JFHaIlHa5qG9yXjqrRDeBDFhPCqXSdeB6TheBkHA/0REagVeF1Faw317C1F8wGTQ4tIVKKWQUiHVAhop5XK9MlfoqIhwXqF72eeqncfI8d9PJsQYE+3HzBHOK2I+1+GsKytULuI0i+usM23l0P6A8dijvF3lIH2I/bKMO5jpKn86iMo6ovoE1f+CNJqzD232kwX2UwWapW9YZjJENrbw7PtMTtJo8QvXnVBIH5JPFsinbEa9MdoE6F4J4SSYHj1G96toDI1ii3cpm/xzm7Nie9ayL8H3xbWi+1dQd1r8qPXw3VlODAUXtS7nJx28gcAiDAkCHYtuTCTsqg2ib6RfFJXcEblHe2TWdjne+xrnqjvHbN7O8OpOlkr2M9bix+hWrzOy91vQOe3Ra/YRo9kDECPBeb3L99oF3lAsCadSxlCRPdSqXRY5gyF6WQEGZXR8vW+aRe4dJLn7/hm5lr0kXLT2TwQmNn0EPTd/pdvgxafdGOVOnT+bjIxtutvhswAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"65a807b1.png\"\n        title=\"65a807b1.png\"\n        src=\"/static/9e5694846c71c77ee5ec10277f629443/1d69c/7.png\"\n        srcset=\"/static/9e5694846c71c77ee5ec10277f629443/4dcb9/7.png 188w,\n/static/9e5694846c71c77ee5ec10277f629443/5ff7e/7.png 375w,\n/static/9e5694846c71c77ee5ec10277f629443/1d69c/7.png 750w,\n/static/9e5694846c71c77ee5ec10277f629443/78797/7.png 1125w,\n/static/9e5694846c71c77ee5ec10277f629443/aa440/7.png 1500w,\n/static/9e5694846c71c77ee5ec10277f629443/668c6/7.png 1692w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p class=\"para\">接下来解释该图中几个关键点的具体工作机制。</p>\n<h4 class=\"heading\" id=\"文档过期\" style=\"position:relative;\"><a href=\"#%E6%96%87%E6%A1%A3%E8%BF%87%E6%9C%9F\" aria-label=\"文档过期 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>文档过期</h4>\n<p class=\"para\">通过通用首部 <code>Cache-Control</code> 和 <code>Expires</code>，HTTP 让服务器对每个文档附加一个“过期时间”，这些首部表示在多长的时间内可以将这些内容视为新鲜的。就像是给食物加上过期时间一样。</p>\n<p class=\"para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/40e0e068bfa048ccb14eda7fe7dcc6be/d9199/8.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.659574468085104%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABV0lEQVQoz3WSiY6DMAxE+///uIGScCVAgSbcZFY2Wwqla8kyQfA8Y+cWhiGiKML9focQAl3X4RXee05QxTv8umzv/745xi2OY1ASNE1T5FqjaRosy/wGbBT4toU3Gt65c8MjkJRJKVnhSyk1CIIAj7rGNM9AEsOHAr4w8NN0cvAZO5BgSZqiKEvkec5VxjHqqgKaGn5dr6PYDlcgzVFJiR8hoJRCUZT4Fvs8D8Cr5ShiYCAEzzDNMrY6zzPGccQ4jZin6Svgq+WQZ6bYLi1EG4Nc53zeMuH6skwIvyycR9Uny3Vd88xIXZZlkErBOoeu6+Gcg7V2+5lAjwq+Ks/Ao0LaptYaxhhk+aaMqrUOwzBwdlSbBkhj4Nnud/KrZbrMtOEokjCmQFVVbD1OEp4pNYiUhM4yPNsWywfsopBgtFnaMFnr+57t9sPAZ3p+Wrvnuqz/XmoC/gIU/VGT10qXRgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"9ef1d5bc.png\"\n        title=\"9ef1d5bc.png\"\n        src=\"/static/40e0e068bfa048ccb14eda7fe7dcc6be/1d69c/8.png\"\n        srcset=\"/static/40e0e068bfa048ccb14eda7fe7dcc6be/4dcb9/8.png 188w,\n/static/40e0e068bfa048ccb14eda7fe7dcc6be/5ff7e/8.png 375w,\n/static/40e0e068bfa048ccb14eda7fe7dcc6be/1d69c/8.png 750w,\n/static/40e0e068bfa048ccb14eda7fe7dcc6be/d9199/8.png 960w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p class=\"para\"><code>Expires</code> 和 <code>Cache-Control: max-age</code> 所做的事情本质上都是过期日期。但前者使用的是绝对时间，定义的是过期的时间，超过这个时间，文档将被视为“过时了”。后者使用的是相对时间，定义的是缓存的使用时间，从第一次生成文档到文档不再新鲜，无法使用位置的最大合法生存时间，单位为秒。</p>\n<p class=\"para\">比如你在2019年3月1日买了一瓶牛奶，<code>Expires</code> 告诉你在3月15日后过期，而<code>Cache-Control:max-age</code> 告诉你是1209600秒 (14 * 24 * 60 * 60) 后过期。</p>\n<p class=\"para\"><strong><code>Expires</code> 是来自HTTP/1.0版本的首部，目前存在的意义主要是向下兼容。</strong></p>\n<h4 class=\"heading\" id=\"服务器再验证\" style=\"position:relative;\"><a href=\"#%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%86%8D%E9%AA%8C%E8%AF%81\" aria-label=\"服务器再验证 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>服务器再验证</h4>\n<p class=\"para\">当缓存的新鲜度不再，意味着到了核对的时间了，缓存需要询问服务器原始文档是否发生了变化。这个过程只有两种结果：</p>\n<ol>\n<li>内容发生了变化，缓存将会获取一份新的文档副本，代替原来的副本，然后文档发给客户端</li>\n<li>内容没有发生变化，缓存获取新的首部，首部中包含新的过期时间，然后更新缓存中的首部</li>\n</ol>\n<p class=\"para\">这种机制的好处在于：按需校验，在保证缓存自动更新的前提下还能够节约服务器资源。</p>\n<p class=\"para\">HTTP提供了一些特殊的条件首部，当一个GET请求在请求首部中带上条件首部时，只有当条件为True时，服务器才会返回对象。</p>\n<h5 class=\"heading\" id=\"If-Modified-Since-Date\" style=\"position:relative;\"><a href=\"#If-Modified-Since-Date\" aria-label=\"If Modified Since Date permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>If-Modified-Since: [Date]</h5>\n<p class=\"para\">如果再指定日期后文档被修改了，条件判定为 True，请求成功后，新的文档将会被缓存，新首部会包含一个新的过期日期。反之响应报文的状态码 <code>304 Not Mofified</code>，不返回文档的主体。</p>\n<p class=\"para\">与响应首部中的<code>Last-Modified</code>配合使用。文档请求成功返回时，服务器将文档的的最后修改日期以<code>Last-Modified</code>加在响应报文中。当缓存进行验证时，将用这个值作为<code>If-Modified-Since</code>首部的字段值：</p>\n<deckgo-highlight-code  theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">If-Modified-Since: &lt;cached last-modified date&gt;</code>\n        </deckgo-highlight-code>\n<p class=\"para\">如果此时文档内容被修改，修改日期就会有所不同，条件判定为True。</p>\n<p class=\"para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9a46e2fe4fb20e4d4d39107fc064f5ad/913a1/9.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 88.29787234042553%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAACPUlEQVQ4y4WTV2tyQRCG/c0SzL8RDCh6I4LeJHhhIgYRC2KLJabZa6KxxDbhGVhZNXzfwngO65nZt63jcDgIxdput7LZbOSvZb6za7/fa9l7Dntgs9mUfD4v7+/v0u/3ZTAYaH1/f8vPz48eaMr02AeyTgZ2Oh0dysC3tzetRqMh9XpdSqWSFAoFSaVSkkgkJJlMyuvrq+RyOVmtVsehDjNsPB7rAD6az+eyXC5lMplIr9fTQxiYTqfl4eFB7u7uJBwJi9frFZfLpSxY0Hfww6LR5/NpeTwerVAopM3xeFyl4LDZbCamJxaLidPp1N7jQNuQaDQq2WxW1uu1FItFqdVqWtVqVelCHzToy+CPjw+5v79XRkfKtqD26na7WsPhUAeAAo2NLOhqBl2YYuzf7XaK1MBHR5pAg9Ofn58yGo0UJXtEjB47Oicut9tteXl5ka+vL3WOgj6HmKZzROc5PaEMpaenJymXy/qEFvpBE70oHEdLaC8WC5lOp4ryIjb82Wq1tNgDFbTQDmOIDK6Gw2Hx+/1yc3MjgUBArq+vVeOL2EA3EolIMBjUD3niOgEmMqCCAYhMkDng6urq79hwtTj59vZWhz8+Pkomk9G4QBvkmEHYMQaa/Od2u/VS/Dc2lUpFdTRagpBhuI0U5m7/GRuzYZzkdHOXMQJ0PE02YcB9twN9YYr9B4Ofn58VJY2g5J09XCYFvNsDT3Job5p3XEcbbgramXcOIDKgx6B/DjzX09wecxt4op2t3zmgXxZqRkEIqL+jAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"209f1f80.png\"\n        title=\"209f1f80.png\"\n        src=\"/static/9a46e2fe4fb20e4d4d39107fc064f5ad/1d69c/9.png\"\n        srcset=\"/static/9a46e2fe4fb20e4d4d39107fc064f5ad/4dcb9/9.png 188w,\n/static/9a46e2fe4fb20e4d4d39107fc064f5ad/5ff7e/9.png 375w,\n/static/9a46e2fe4fb20e4d4d39107fc064f5ad/1d69c/9.png 750w,\n/static/9a46e2fe4fb20e4d4d39107fc064f5ad/78797/9.png 1125w,\n/static/9a46e2fe4fb20e4d4d39107fc064f5ad/913a1/9.png 1476w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p class=\"para\">用 Node.js 来简单实现这个过程：</p>\n<deckgo-highlight-code language=\"js\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">const http = require(&quot;http&quot;);\nconst url = require(&quot;url&quot;);\nconst fs = require(&quot;fs&quot;);\nconst path = require(&quot;path&quot;);\n\nconst mimeList = {\n  css: &quot;text/css&quot;,\n  gif: &quot;image/gif&quot;,\n  html: &quot;text/html&quot;,\n  ico: &quot;image/x-icon&quot;,\n  jpeg: &quot;image/jpeg&quot;,\n  jpg: &quot;image/jpeg&quot;,\n  js: &quot;text/javascript&quot;,\n  json: &quot;application/json&quot;,\n  pdf: &quot;application/pdf&quot;,\n  png: &quot;image/png&quot;,\n  svg: &quot;image/svg+xml&quot;,\n  swf: &quot;application/x-shockwave-flash&quot;,\n  tiff: &quot;image/tiff&quot;,\n  txt: &quot;text/plain&quot;,\n  wav: &quot;audio/x-wav&quot;,\n  wma: &quot;audio/x-ms-wma&quot;,\n  wmv: &quot;video/x-ms-wmv&quot;,\n  xml: &quot;text/xml&quot;\n};\n\nconst Expires = {\n  maxAge: 60 * 60 * 24 * 365\n};\n\nconst server = http.createServer((req, res) =&gt; {\n  const pathname = url.parse(req.url).pathname; //解析路径\n  const resourcePath = path.join(__dirname , pathname);\n  const suffix = path.extname(pathname).slice(1); //获取后缀\n  const contentType = mimeList[suffix];\n\n  if (fs.existsSync(resourcePath)) {\n    //判断资源是否存在，存在则读取\n    fs.stat(resourcePath, function(err, stat) {\n\n      // stat.mtime 返回 文件最后修改的时间\n      const lastModified = stat.mtime.toUTCString();\n      const ifModifiedSince = &quot;If-Modified-Since&quot;.toLowerCase();\n      const expires = new Date();\n\n      res.setHeader(&quot;Last-Modified&quot;, lastModified);\n      res.setHeader(&quot;Content-Type&quot;, contentType);\n      res.setHeader(&quot;Expires&quot;, expires.toUTCString());\n      res.setHeader(&quot;Cache-Control&quot;, &quot;max-age=&quot; + Expires.maxAge);\n\n      expires.setTime(expires.getTime() + Expires.maxAge * 1000);\n\n      // 服务端的lastModified 与请求中携带的 “If-Modified-Since”的字段值对比\n      if (req.headers[ifModifiedSince] &amp;&amp; lastModified == req.headers[ifModifiedSince]) {\n        //实现304逻辑\n        res.writeHead(304, &quot;Not Modified&quot;);\n\n        // 注意：此处没有返回资源\n        res.end();\n      } else {\n        const resource = fs.createReadStream(resourcePath);\n\n        res.writeHead(200, &quot;Ok&quot;);\n        resource.pipe(res);\n      }\n    });\n  } else {\n    res.writeHead(404, { &quot;Content-Type&quot;: contentType });\n    res.write(&quot;No Found&quot;);\n    res.end();\n  }\n});\n\nserver.listen(8080, function() {\n  console.log(&quot;Server Listen: http://localhost:8080&quot;);\n});</code>\n        </deckgo-highlight-code>\n<ol>\n<li>在第一次请求时，因为本地没有缓存，node server 返回状态码 200和实体文件，响应首部增加 <code>Last-Modified</code></li>\n<li>command+R 刷新页面(此时浏览器会给请求加上一个Cache-Control: max-age=0)。在第二次请求时，请求报文增加 <code>If-Modified-Since</code>，值为第一次请求时返回的<code>Last-Modified</code>。因为文件的最后修改时间没有发生变化，server 返回 304。</li>\n<li>重新编辑资源文件，再次刷新访问，请求报文依旧增加 <code>If-Modified-Since</code>，值为第一次请求时返回的 <code>Last-Modified</code>。此时 server 判定缓存失效，返回状态码 200和资源内容</li>\n</ol>\n<h5 class=\"heading\" id=\"If-None-Match-ETag\" style=\"position:relative;\"><a href=\"#If-None-Match-ETag\" aria-label=\"If None Match ETag permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>If-None-Match: [ETag]</h5>\n<p class=\"para\">有些情况下，仅使用最后修改时间来做验证是不够的：</p>\n<ul>\n<li>有时候文档被重写，内容没有变化，但是修改时间变化</li>\n<li>有时候文档修改的内容不重要，对使用也没有影响</li>\n<li>有的服务器无法准确判断最后修改时间</li>\n<li>有的场景下文档的数据需要精确亚秒级别，比如实时监控。而 Last-Modified 只能精确到秒</li>\n</ul>\n<p class=\"para\">为了解决这个问题，引入了ETag(实体标签)作为版本标识符。ETag 是根据资源本身的特征经过计算得到的一个值，用来标识一个资源。并不像 Last-Modified 那样直接依赖修改时间而是依赖资源，所以要更加可靠和灵活。ETag在响应返回的时候附加在报文中，当文档发生了修改之后，可以修改对应的ETag来表名这是一个新的版本。缓存可以通过<code>If-None-Match</code>的校验结果来判断使用缓存还是重新获取文档。</p>\n<p class=\"para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3af287e681685457d124639ed4f23eef/1134b/10.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 34.04255319148936%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABFElEQVQoz22R3aqCUBCFe/9X8N4X6E666KKgiwxEDAWxtChD0dLS8m8d1sDuHPEMDLNxO2u+tWc2DAMYbdsiiiLEcYymafB+vyWrqpK7/4K9ql/VmTpQxPd9OI4D13URBAEOhwNutxuKohgJMPu+Hwmr+hUkzeVyESJ+I1We5zidTtjv99jtdlgul5jP59B1HZqmiZssy/D5fH4F1YFCTFItFgtsNhtJ0zRh27bQH49HnM9noeag+/0uSXcTQtKkaSo/r1YrGIYhdb1eY7vdwrIshGGIsizFTdd1QsghdV1PBTnl+Xx+7dMmBUiSJInU6/UqScrH44HX6yUg6j1Hlv8GJ5KU78NGLoVVWeSd53mTjXPLPzZgEkFFo+t2AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"054048af.png\"\n        title=\"054048af.png\"\n        src=\"/static/3af287e681685457d124639ed4f23eef/1d69c/10.png\"\n        srcset=\"/static/3af287e681685457d124639ed4f23eef/4dcb9/10.png 188w,\n/static/3af287e681685457d124639ed4f23eef/5ff7e/10.png 375w,\n/static/3af287e681685457d124639ed4f23eef/1d69c/10.png 750w,\n/static/3af287e681685457d124639ed4f23eef/78797/10.png 1125w,\n/static/3af287e681685457d124639ed4f23eef/1134b/10.png 1470w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p class=\"para\">ETag的生成规则没有严格规定包括，文档内容的hash值，对最后修改时间的hash值，甚至是约定的版本号。作为服务器再验证机制中的一环，有强弱之分</p>\n<p class=\"para\">强校验的ETag匹配要求两个资源内容的每个字节需完全相同，包括所有其他实体字段（如Content-Language）不发生变化。一个强校验ETag校验符的表示形式：“22FAA065-2664-4197-9C5E-C92EA03D0A16”。</p>\n<p class=\"para\">弱校验的ETag匹配要求两个资源在语义上相等，不需要每个字节相同。一个弱校验ETag校验符的表现形式：w/”22FAA065-2664-4197-9C5E-C92EA03D0A16”。</p>\n<p class=\"para\">同样用Node.js 来简单实现：</p>\n<deckgo-highlight-code language=\"js\" theme=\"one-dark\" line-numbers=\"true\"  >\n          <code slot=\"code\">const server = http.createServer((req, res) =&gt; {\n  const pathname = url.parse(req.url).pathname; //解析路径\n  const resourcePath = path.join(__dirname, pathname);\n  const suffix = path.extname(pathname).slice(1); //获取后缀\n  const contentType = mimeList[suffix];\n\n  if (fs.existsSync(resourcePath)) {\n    //判断资源是否存在，存在则读取\n    fs.stat(resourcePath, function(err, stat) {\n      const resource = fs.readFileSync(resourcePath);\n\n      let hash = crypto.createHash(&quot;sha1&quot;);\n      let tag = hash.update(resource).digest(&quot;base64&quot;);\n\n      console.log(tag);\n\n      res.setHeader(&#39;ETag&#39;, tag);\n\n      if (req.headers[&quot;if-none-match&quot;] === tag) {\n        res.writeHead(304);\n        res.end();\n\n        return;\n      }\n\n      res.writeHead(200);\n      res.end(resource);\n      // res.writeHead(200, &quot;Ok&quot;);\n    });\n  } else {\n    res.writeHead(404, { &quot;Content-Type&quot;: contentType });\n    res.write(&quot;No Found&quot;);\n    res.end();\n  }\n});\n\nserver.listen(8080, function() {\n  console.log(&quot;Server Listen: http://localhost:8080&quot;);\n});</code>\n        </deckgo-highlight-code>\n<ol>\n<li>在第一次请求时，因为本地没有缓存，node server 返回状态码 200和实体文件，响应首部增加 <code>ETag</code></li>\n<li>command+R 刷新页面(此时浏览器会给请求加上一个Cache-Control: max-age=0)。在第二次请求时，请求报文增加 <code>If-None-Match</code>，值为第一次请求时返回的<code>ETag</code>。因为文件的内容没有发生变化，server 返回 304。</li>\n<li>重新编辑资源文件，再次刷新访问，请求报文依旧增加 <code>ETag</code>，值为第一次请求时返回的 <code>ETag</code>。此时server获取到的ETag值已经发生了变化，判定缓存失效，返回状态码 200和资源内容</li>\n</ol>\n<h5 class=\"heading\" id=\"If-Unmodified-Since-Date\" style=\"position:relative;\"><a href=\"#If-Unmodified-Since-Date\" aria-label=\"If Unmodified Since Date permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>If-Unmodified-Since: Date</h5>\n<p class=\"para\">类似于If-Modified-Since，意义相反。区别是当服务器资源条件不满足时，不是返回 304 Not Modified，而是返回 412 Precondition Failed。</p>\n<h5 class=\"heading\" id=\"If-Match-ETag\" style=\"position:relative;\"><a href=\"#If-Match-ETag\" aria-label=\"If Match ETag permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>If-Match: ETag</h5>\n<p class=\"para\">和If-None-Match 相反</p>\n<p class=\"para\">说了这么多，再回到之前 GET 请求的缓存流程，结合刚才的解释，可以重新绘制一个流程图：</p>\n<p class=\"para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c7af3968afa863754291287db3746718/6cb28/11.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64.8936170212766%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACFUlEQVQ4y52T7UsUURTG/WfrL+hbXwqKosAvgoR/QAVqQkKEmpRZuqaZ0Qq+rW+o67obuzN7Z+499+UXc2fSdP3UgQMz5555eO7zPDN0ml4wsjrBy/os1luKCiH8Vxc11JWc93s1Fo/ruGp4vQIEf8tscLcAHUI1oT4GjSnyLMU6jw8e5z3WOawHB1gfcM7H8zgLxOdy5nDOlQwlT0j23qHPVwnBY63D5IJoi/cOl10gnU28KIwxeCc41cL2DvBWI2Kw1iJiK8BmjbT2EPV9GKeOOdxsMv1khqXXP/C6iVp7RjJ/h3zrFUbnyPka/W+P6X2+R74zjuQ9pCAhUgLiLdJtIOlp1MZZR5bkGGXiglG/0d0jQmWYN0kETRuzSHpWMvYesRXDuFT1beUkR6etKLgvPjxbQq09RdUeYHbHMaqDERvluAQUY9A6v4qML+GdapJvDNP/dBe9O0GWqWhGrrpkaTsa4QqzCgO9uwIsDqwdzGDBu986or2zgsvTMi4EtLFocdW+RytDr51ita2u7Ev7rwH6Mmcrb34x9Wiew59n8b1wU0Twzl2Guf5hm+nnc+ws7w8CDmhoLFma4e0VwM3a+3rIwotljtdPqitXLv0V/t8OBMTZS+bWWC4OOrT2O4guo7KxscXk5Bzb2wcVwxAiYPwzbnaVsULjAj7p9JkbXWRmZIFuO4mAbxtfuL88xseTdf4A1XTkpNKbS54AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"704be86d.png\"\n        title=\"704be86d.png\"\n        src=\"/static/c7af3968afa863754291287db3746718/1d69c/11.png\"\n        srcset=\"/static/c7af3968afa863754291287db3746718/4dcb9/11.png 188w,\n/static/c7af3968afa863754291287db3746718/5ff7e/11.png 375w,\n/static/c7af3968afa863754291287db3746718/1d69c/11.png 750w,\n/static/c7af3968afa863754291287db3746718/78797/11.png 1125w,\n/static/c7af3968afa863754291287db3746718/aa440/11.png 1500w,\n/static/c7af3968afa863754291287db3746718/6cb28/11.png 2430w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3 class=\"heading\" id=\"与缓存相关的首部\" style=\"position:relative;\"><a href=\"#%E4%B8%8E%E7%BC%93%E5%AD%98%E7%9B%B8%E5%85%B3%E7%9A%84%E9%A6%96%E9%83%A8\" aria-label=\"与缓存相关的首部 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>与缓存相关的首部</h3>\n<p class=\"para\">总结一下目前涉及到的一些与缓存相关的首部字段，方便大家理解和体会：</p>\n<p class=\"para\"><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 750px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/12989c5f854e258b1a9d8cbc9bfaada2/71ba4/12.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.319148936170215%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABuklEQVQoz22TaarcMBCEfd+QG4TcJAfIz0B+BXKHECZhBmbxMuNVXiVblmWpQrefIW8YgZCNrdLXVa0AALz3L+fz0FpjsRZSSmRZhqqqIIRAURao6xrOOQT7xlcC1losy8LrOE1o2xZSKhY7Ho+I4xi38IY4iVlYzzOCZzE1TWj6HrMxMMZgmiZeh2FA07bouh5FWeJ8PiOKIuR5zoftYyP0Hm510HpGVlU4Xi5Q44TVWqzOMeE8z8iLAnGS4PF44BaG/Nx2HZNTuZvg7o8xWNf1XclER76RGG2iSaTjuFHTNzqMxPYqA6Lz1kIT0bqiEALnMIRUIyohcL1emSzNMhz+HPidhJ7HHmSAL1/hP3yC+/gZ7nCC8o69IoP7fkBZlqjrBuM4svGULBG+Gpvgr7/w339i/vYDJi2gV4t+GLg9KGESuj/unGxyT7hkmkpJdF0HpRT6vuf1nYcjgMV7lELgEkWctjEL/0wtEoYh0jRlwrqp0TQNJ8x9WGx9yISe0nEORs9sPvlIhpPR5q11hKh4E1FQUERN82XJ/9+KZbFIshy/TycOhUoSomYq6jkiHKRkK8xbVzzfrH+DQE24lFaLoAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"24cb815b.png\"\n        title=\"24cb815b.png\"\n        src=\"/static/12989c5f854e258b1a9d8cbc9bfaada2/1d69c/12.png\"\n        srcset=\"/static/12989c5f854e258b1a9d8cbc9bfaada2/4dcb9/12.png 188w,\n/static/12989c5f854e258b1a9d8cbc9bfaada2/5ff7e/12.png 375w,\n/static/12989c5f854e258b1a9d8cbc9bfaada2/1d69c/12.png 750w,\n/static/12989c5f854e258b1a9d8cbc9bfaada2/78797/12.png 1125w,\n/static/12989c5f854e258b1a9d8cbc9bfaada2/aa440/12.png 1500w,\n/static/12989c5f854e258b1a9d8cbc9bfaada2/71ba4/12.png 1870w\"\n        sizes=\"(max-width: 750px) 100vw, 750px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p class=\"para\">内容有些许枯燥，但还是希望能够帮助大家理解</p>\n<p class=\"para\"><strong>参考资料</strong></p>\n<ol>\n<li><a href=\"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Caching_FAQ#%E5%90%84%E7%A7%8D%E7%B1%BB%E5%9E%8B%E7%9A%84%E7%BC%93%E5%AD%98\" class=\"link-underline\">HTTP 缓存 - HTTP | MDN</a></li>\n<li><a href=\"https://blog.fundebug.com/2019/01/08/browser-cache-mechanism/\" class=\"link-underline\">浏览器缓存机制 | Fundebug博客</a></li>\n<li><a href=\"https://swiftcachelite.swiftserve.com/different-types-of-caching-and-their-differences/\" class=\"link-underline\">Different Types of Caching and Their Differences - SwiftCache Lite</a></li>\n<li><a href=\"https://stackoverflow.com/questions/49547/how-to-control-web-page-caching-across-all-browsers\" class=\"link-underline\">http - How to control web page caching, across all browsers? - Stack Overflow</a></li>\n<li><a href=\"https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/http-caching\" class=\"link-underline\">HTTP Caching  |  Web Fundamentals  |  Google Developers</a></li>\n<li><a href=\"https://www.wikiwand.com/en/HTTP_ETag\" class=\"link-underline\">HTTP ETag - Wikiwand</a></li>\n</ol>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#http-%E7%BC%93%E5%AD%98\">HTTP 缓存</a></p>\n</li>\n<li>\n<p><a href=\"#%E7%BC%93%E5%AD%98%E7%9A%84%E5%88%86%E7%B1%BB\">缓存的分类</a></p>\n</li>\n<li>\n<p><a href=\"#http-%E7%9A%84%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D\">HTTP 的简单介绍</a></p>\n<ul>\n<li><a href=\"#http-%E5%8D%8F%E8%AE%AE\">HTTP 协议</a></li>\n<li><a href=\"#http-%E6%8A%A5%E6%96%87\">HTTP 报文</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E7%BC%93%E5%AD%98%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%9C%BA%E5%88%B6\">缓存的工作机制</a></p>\n<ul>\n<li>\n<p><a href=\"#%E6%96%B0%E9%B2%9C%E5%BA%A6%E6%A3%80%E6%B5%8B%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%86%8D%E9%AA%8C%E8%AF%81\">新鲜度检测和服务器再验证</a></p>\n<ul>\n<li>\n<p><a href=\"#%E6%96%87%E6%A1%A3%E8%BF%87%E6%9C%9F\">文档过期</a></p>\n</li>\n<li>\n<p><a href=\"#%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%86%8D%E9%AA%8C%E8%AF%81\">服务器再验证</a></p>\n<ul>\n<li><a href=\"#if-modified-since-date\">If-Modified-Since: [Date]</a></li>\n<li><a href=\"#if-none-match-etag\">If-None-Match: [ETag]</a></li>\n<li><a href=\"#if-unmodified-since-date\">If-Unmodified-Since: Date</a></li>\n<li><a href=\"#if-match-etag\">If-Match: ETag</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%E4%B8%8E%E7%BC%93%E5%AD%98%E7%9B%B8%E5%85%B3%E7%9A%84%E9%A6%96%E9%83%A8\">与缓存相关的首部</a></p>\n</li>\n</ul>\n</li>\n</ul>","headings":[{"id":"HTTP-缓存","depth":2,"value":"HTTP 缓存"},{"id":"缓存的分类","depth":2,"value":"缓存的分类"},{"id":"HTTP-的简单介绍","depth":2,"value":"HTTP 的简单介绍"},{"id":"HTTP-协议","depth":3,"value":"HTTP 协议"},{"id":"HTTP-报文","depth":3,"value":"HTTP 报文"},{"id":"缓存的工作机制","depth":2,"value":"缓存的工作机制"},{"id":"新鲜度检测和服务器再验证","depth":3,"value":"新鲜度检测和服务器再验证"},{"id":"文档过期","depth":4,"value":"文档过期"},{"id":"服务器再验证","depth":4,"value":"服务器再验证"},{"id":"If-Modified-Since-Date","depth":5,"value":"If-Modified-Since: [Date]"},{"id":"If-None-Match-ETag","depth":5,"value":"If-None-Match: [ETag]"},{"id":"If-Unmodified-Since-Date","depth":5,"value":"If-Unmodified-Since: Date"},{"id":"If-Match-ETag","depth":5,"value":"If-Match: ETag"},{"id":"与缓存相关的首部","depth":3,"value":"与缓存相关的首部"}],"frontmatter":{"title":"浅谈 HTTP 缓存","date":"2019-03-09","cover":null,"description":null,"categories":["技术学习"],"tags":["HTTP"]}},"previous":{"fields":{"slug":"/blogs/从getBoundingClientRect到Intersection Observer/"},"frontmatter":{"title":"从getBoundingClientRect到Intersection Observer"}},"next":{"fields":{"slug":"/blogs/2019-01-26-巧用-webpack-loader-实现项目的定制化/"},"frontmatter":{"title":"巧用 webpack loader 实现项目的定制化","tags":["Webpack"],"categories":["技术应用"],"status":null}}},"pageContext":{"id":"e684b29e-a44d-5534-8d03-2980ca03d355","previousPostId":"b38353a8-4aab-53d4-a7ba-848e22f02c73","nextPostId":"c78dc207-20e3-54bd-affc-a2a935bab2a3"}},
    "staticQueryHashes": ["2841359383"]}